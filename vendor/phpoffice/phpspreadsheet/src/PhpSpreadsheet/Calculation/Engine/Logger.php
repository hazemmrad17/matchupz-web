<?php

namespace PhpOffice\PhpSpreadsheet\Calculation\Engine;

class Logger
{
    /**
     * Flag to determine whether a debug log should be generated by the calculation engine
     *        If true, then a debug log will be generated
     *        If false, then a debug log will not be generated.
<<<<<<< HEAD
     *
     * @var bool
     */
    private $writeDebugLog = false;
=======
     */
    private bool $writeDebugLog = false;
>>>>>>> match

    /**
     * Flag to determine whether a debug log should be echoed by the calculation engine
     *        If true, then a debug log will be echoed
     *        If false, then a debug log will not be echoed
     * A debug log can only be echoed if it is generated.
<<<<<<< HEAD
     *
     * @var bool
     */
    private $echoDebugLog = false;
=======
     */
    private bool $echoDebugLog = false;
>>>>>>> match

    /**
     * The debug log generated by the calculation engine.
     *
     * @var string[]
     */
<<<<<<< HEAD
    private $debugLog = [];

    /**
     * The calculation engine cell reference stack.
     *
     * @var CyclicReferenceStack
     */
    private $cellStack;
=======
    private array $debugLog = [];

    /**
     * The calculation engine cell reference stack.
     */
    private CyclicReferenceStack $cellStack;
>>>>>>> match

    /**
     * Instantiate a Calculation engine logger.
     */
    public function __construct(CyclicReferenceStack $stack)
    {
        $this->cellStack = $stack;
    }

    /**
     * Enable/Disable Calculation engine logging.
<<<<<<< HEAD
     *
     * @param bool $writeDebugLog
     */
    public function setWriteDebugLog($writeDebugLog): void
=======
     */
    public function setWriteDebugLog(bool $writeDebugLog): void
>>>>>>> match
    {
        $this->writeDebugLog = $writeDebugLog;
    }

    /**
     * Return whether calculation engine logging is enabled or disabled.
<<<<<<< HEAD
     *
     * @return bool
     */
    public function getWriteDebugLog()
=======
     */
    public function getWriteDebugLog(): bool
>>>>>>> match
    {
        return $this->writeDebugLog;
    }

    /**
     * Enable/Disable echoing of debug log information.
<<<<<<< HEAD
     *
     * @param bool $echoDebugLog
     */
    public function setEchoDebugLog($echoDebugLog): void
=======
     */
    public function setEchoDebugLog(bool $echoDebugLog): void
>>>>>>> match
    {
        $this->echoDebugLog = $echoDebugLog;
    }

    /**
     * Return whether echoing of debug log information is enabled or disabled.
<<<<<<< HEAD
     *
     * @return bool
     */
    public function getEchoDebugLog()
=======
     */
    public function getEchoDebugLog(): bool
>>>>>>> match
    {
        return $this->echoDebugLog;
    }

    /**
     * Write an entry to the calculation engine debug log.
<<<<<<< HEAD
     *
     * @param mixed $args
     */
    public function writeDebugLog(string $message, ...$args): void
    {
        //    Only write the debug log if logging is enabled
        if ($this->writeDebugLog) {
            $message = sprintf($message, ...$args);
=======
     */
    public function writeDebugLog(string $message, mixed ...$args): void
    {
        //    Only write the debug log if logging is enabled
        if ($this->writeDebugLog) {
            $message = sprintf($message, ...$args); //* @phpstan-ignore-line
>>>>>>> match
            $cellReference = implode(' -> ', $this->cellStack->showStack());
            if ($this->echoDebugLog) {
                echo $cellReference,
                ($this->cellStack->count() > 0 ? ' => ' : ''),
                $message,
                PHP_EOL;
            }
<<<<<<< HEAD
            $this->debugLog[] = $cellReference .
                ($this->cellStack->count() > 0 ? ' => ' : '') .
                $message;
=======
            $this->debugLog[] = $cellReference
                . ($this->cellStack->count() > 0 ? ' => ' : '')
                . $message;
>>>>>>> match
        }
    }

    /**
     * Write a series of entries to the calculation engine debug log.
     *
     * @param string[] $args
     */
    public function mergeDebugLog(array $args): void
    {
        if ($this->writeDebugLog) {
            foreach ($args as $entry) {
                $this->writeDebugLog($entry);
            }
        }
    }

    /**
     * Clear the calculation engine debug log.
     */
    public function clearLog(): void
    {
        $this->debugLog = [];
    }

    /**
     * Return the calculation engine debug log.
     *
     * @return string[]
     */
<<<<<<< HEAD
    public function getLog()
=======
    public function getLog(): array
>>>>>>> match
    {
        return $this->debugLog;
    }
}
